# MySQL 초기 데이터 주입 작업 로그

## 1. 개요
MySQL 클러스터에 데이터베이스(`exam`, `candidate`)와 테이블(`exam_info`)을 생성하고, 초기 데이터를 삽입하기 위한 작업을 수행했습니다. 또한 사용자 계정(`jiwon`, `repl_user`) 생성 및 권한 부여도 포함됩니다.

## 2. 생성된 파일
1.  **`workspace/k8s-project/mysql/init.sql`**: 초기화 SQL 스크립트 원본.
2.  **`workspace/k8s-project/mysql/mysql-init-job.yaml`**:
    *   **ConfigMap (`mysql-init-sql-configmap`)**: `init.sql` 내용을 포함.
    *   **Job (`mysql-init-job`)**: `mysql:8.0` 이미지를 사용하여 클러스터에 접속하고 SQL을 실행하는 일회성 작업.

## 3. 실행 방법 (사용자 수행)
마스터 노드에서 다음 명령어를 실행하여 초기화 작업을 수행합니다.

```bash
# Job 생성 및 실행
kubectl apply -f workspace/k8s-project/mysql/mysql-init-job.yaml

# 실행 로그 확인
kubectl logs -f job/mysql-init-job
```

## 4. 트러블슈팅
*   **Job 실패 시**: `mysql-cluster` 서비스에 접속할 수 없는 경우(예: 클러스터가 아직 준비되지 않음), Job은 실패 후 재시도(`restartPolicy: OnFailure`)합니다.
*   **비밀번호 오류**: `secret.yaml`의 `rootPassword` 키를 참조하도록 설정했으므로, Secret이 올바르게 생성되어 있어야 합니다.

## 5. 참고 사항
*   이 작업은 MySQL 클러스터가 최소한 읽기/쓰기 가능한 상태(Primary 노드 정상 동작)여야 성공합니다.
*   데이터 중복 삽입을 방지하려면 `init.sql` 내의 `INSERT` 구문을 `INSERT IGNORE`로 변경하거나 테이블을 비우는 로직을 추가해야 합니다.
